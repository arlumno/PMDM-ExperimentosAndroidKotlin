package com.example.pmdm_experimentosandroidkotlin

import android.util.Log

class Calculadora {
    var numeroActual: Long? = null
    var numeroAnterior: Long? = null
    var operacion: String = ""
    var resultadoUltimaOperacion: String? = null
    val maxDigitos = 9

    val textDisplay: String
        get() = numeroActual?.toString() ?: numeroAnterior?.toString()?: resultadoUltimaOperacion ?: "0"

    val textDisplayMin: String
        get() = numeroAnterior?.toString() ?: ""

    val textOperacion: String
        get() = operacion


    fun pushNumero(numeroPulsado: Int) {
        Log.d("::::Ar", "pushNumero numero: $numeroPulsado")
        if ((numeroActual ?: 0).toString().length < maxDigitos) numeroActual = (numeroActual ?: 0) * 10 + numeroPulsado.toLong()
        Log.d("::::Ar", "pushNumero display $numeroActual")
    }

    fun pushPunto() {

    }

    fun pushOperacion(operacionPulsada: String) {
        if(numeroAnterior == null){
            numeroActual.let {
                numeroAnterior = numeroActual
                numeroActual = null
            }
        }
        numeroActual = null
        operacion = operacionPulsada

    }


    fun pushClear() {
        numeroActual = null
        numeroAnterior = null
        resultadoUltimaOperacion = null
        operacion = ""
    }

    fun pushIgual() {
        var resultadoOperacion: Long = 0
        if (numeroActual != null && numeroAnterior != null){
            when (operacion) {
                "+" -> resultadoOperacion = numeroAnterior!! + numeroActual!!
                "-" -> resultadoOperacion = numeroAnterior!! - numeroActual!!
                "X" -> resultadoOperacion = numeroAnterior!! * numeroActual!!
                "/" ->{
                    if(numeroActual != 0L)  resultadoOperacion = numeroAnterior!! / numeroActual!!
                }
            }
        }
        pushClear()
        numeroAnterior = resultadoOperacion
        resultadoUltimaOperacion = resultadoOperacion.toString()
    }
}
